"use strict";function createPackageFromTemplate(e,a){var t=Path.basename(e);Fs.copy(templatePath,e,function(r){if(r)return a(r);setPackageName(t,e,a)})}function setPackageName(e,a,t){var r=Path.basename(templatePath);return replaceNameIn(Path.join(a,"package.json"),r,e),replaceNameIn(Path.join(a,"main.js"),r,e),replaceNameIn(Path.join(a,"panel","index.js"),r,e),t(null)}function replaceNameIn(e,a,t){var r=Fs.readFileSync(e,{encoding:"utf8"});Fs.writeFileSync(e,r.replace(new RegExp(a,"ig"),t),{encoding:"utf8"})}const ipcMain=require("electron").ipcMain,Path=require("path"),Fs=require("fire-fs"),templatePath=Editor.url("unpack://static/package-template");ipcMain.on("editor:create-package",(e,a)=>{var t="";"global"===a?t=Path.join(Editor.App.home,"packages"):"project"===a&&(t=Path.join(Editor.projectPath,"packages"));var r=Editor.Dialog.saveFile({title:Editor.T("MESSAGE.package.title"),defaultPath:t,buttonLabel:Editor.T("MESSAGE.package.create")});if(r)return Fs.isDirSync(r)?(Editor.error("Failed to create package at "+r+", Directory already exists!"),void 0):(createPackageFromTemplate(r,function(e){e?Editor.error(e):Editor.success("Create package successfully at "+r)}),void 0)});
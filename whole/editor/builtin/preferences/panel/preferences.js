"use strict";let rootUrl="packages://preferences/panel/";const Utils=Editor.require(rootUrl+"utils"),General=Editor.require(rootUrl+"general"),DataEditor=Editor.require(rootUrl+"data-editor"),NativeDevelop=Editor.require(rootUrl+"native-develop"),PreviewRun=Editor.require(rootUrl+"preview-run"),Fs=require("fs");let createVue=function(e,r){let i=Utils.deepCopyObject(r.data,{});return new Vue({el:e,data:{profile:i,lang:i.language,localIp:i["local-ip"],tabIdx:0,tabs:[{title:Editor.T("PREFERENCES.tab.general"),active:!0,error:!1},{title:Editor.T("PREFERENCES.tab.data_editor"),active:!1,error:!1},{title:Editor.T("PREFERENCES.tab.native_develop"),active:!1,error:!1},{title:Editor.T("PREFERENCES.tab.preview_run"),active:!1,error:!1}],messages:[],global_error:!1},methods:{T:Editor.T,_onTabClick(e){this.tabIdx=e,Editor.Ipc.sendToMain("preferences:update-tab",this.tabIdx)},_onSaveClick(e){e.stopPropagation();let r=Utils.deepCopyObject(i,{});for(var t in r)Utils.setProfile(t,r[t]);let a=Utils.profile;if(a.save){a.save(),Editor.Ipc.sendToAll("app:global-step-changed",a.data.step);var n=a.data["local-ip"];this.localIp!==n&&(this.localIp=n,Editor.Ipc.sendToMainWin("profile:local-ip",{localIp:n})),Editor.Ipc.sendToMain("preferences:save-simulator-config",Utils.getConfigPath(),Utils.getSimulatorConfig(!0)),Editor.Ipc.sendToMain("preferences:close",{langChanged:this.lang!==a.data.language})}}},components:{general:General,"data-editor":DataEditor,"native-develop":NativeDevelop,"preview-run":PreviewRun}})};Editor.Panel.extend({style:Fs.readFileSync(Editor.url("packages://preferences/panel/preferences.css"))+"",template:'\n        <div id="wrapper">\n\n            <div class="left-side">\n                <ul class="tabs">\n\n                    <li v-for="item in tabs"\n                        v-on:click="_onTabClick($index)"\n                        v-bind:class="{active: tabIdx==$index}">\n                        <i class="fa fa-exclamation-triangle icon error" v-show="item.error"></i>\n                        {{item.title}}\n                    </li>\n                </ul>\n            </div>\n\n            <div class="right-side">\n                <div class="flex-1 layout vertical">\n                    <general v-if="tabIdx===0"\n                             v-bind:profile="profile">\n                    </general>\n                    <data-editor v-if="tabIdx===1"\n                                 v-bind:profile="profile"\n                                 v-bind:error.sync="tabs[1].error"\n                                 v-bind:globalerror.sync="global_error">\n                    </data-editor>\n                    <native-develop v-if="tabIdx===2"\n                                    v-bind:profile="profile"\n                                    v-bind:error.sync="tabs[2].error"\n                                    v-bind:globalerror.sync="global_error">\n                    </native-develop>\n                    <preview-run v-if="tabIdx===3"\n                                 v-bind:profile="profile"\n                                 v-bind:error.sync="tabs[3].error"\n                                 v-bind:globalerror.sync="global_error">\n                    </preview-run>\n                </div>\n\n                <div class="footer layout horizontal">\n                    <span class="flex-1"></span>\n                    <ui-button class="green big"\n                               v-on:confirm="_onSaveClick"\n                               v-disabled="global_error">\n                        {{T(\'PREFERENCES.save_close\')}}\n                    </ui-button>\n                </div>\n            </div>\n\n        </div>\n    ',messages:{"update-tab"(e,r){this._vm.tabIdx=r}},ready(){Editor.Profile.load("profile://global/settings.json",(e,r)=>{Utils.profile=r,this._vm=createVue(this.shadowRoot,r),Editor.Ipc.sendToMain("preferences:query-tab",(e,r)=>{if(e)return Editor.warn(e);this._vm.tabIdx=r})})}});
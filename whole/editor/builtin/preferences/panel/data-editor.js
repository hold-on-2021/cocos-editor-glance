"use strict";const Fs=require("fire-fs"),Path=require("fire-path"),Utils=Editor.require("packages://preferences/panel/utils"),DefaultScriptEditor="default";exports.template=`\n    <div class="data-editor">\n\n        <h2>\n            {{T('PREFERENCES.tab.data_editor')}}\n            <div class="layout horizontal center error" v-show="errorInfo!==''">\n                <i class="fa fa-exclamation-triangle icon"></i>\n                <div>{{errorInfo}}</div>\n            </div>\n        </h2>\n\n        \x3c!--激活编辑器时自动编译脚本--\x3e\n\n        <ui-prop\n            name="{{T('PREFERENCES.auto_compiler_scripts')}}"\n            tooltip="{{T('PREFERENCES.auto_compiler_scripts')}}"\n        >\n            <ui-checkbox v-value=profile['auto-compiler-scripts']></ui-checkbox>\n        </ui-prop>\n\n        \x3c!--外部脚本编辑器--\x3e\n\n        <ui-prop\n            name="{{T('PREFERENCES.external_script_editor')}}"\n            tooltip="{{T('PREFERENCES.external_script_editor')}}"\n        >\n            <ui-select id="script_editors"\n                v-value=profile['script-editor']\n                v-on:change="onSelectScriptEditor"\n            >\n\n                <template\n                    v-if="platform === 'win32'"\n                >\n                    <option value="default">{{T('PREFERENCES.vacancy')}}</option>\n                </template>\n                <template\n                    v-else\n                >\n                    <option value="default">{{T('PREFERENCES.internal')}}</option>\n                </template>\n\n                <option v-for="item in profile['script-editor-list']" v-value=item.value>{{item.text}}</option>\n            </ui-select>\n            <ui-button class="small"\n                v-on:confirm="onBrowseScriptEditorClick"\n            >\n                {{T('PREFERENCES.browse')}}\n            </ui-button>\n            <ui-button class="small"\n                v-show="show_remove"\n                v-on:confirm="onRemoveScriptEditorClick"\n            >\n                {{T('PREFERENCES.remove')}}\n            </ui-button>\n        </ui-prop>\n\n        \x3c!--外部图片编辑器--\x3e\n\n        <ui-prop\n            name="{{T('PREFERENCES.external_picture_editor')}}"\n            tooltip="{{T('PREFERENCES.external_picture_editor')}}"\n        >\n            <ui-input class="flex-2"\n                v-value=picture_editor_root\n                placeholder=${Editor.T("PREFERENCES.picture_editor_placeholder")}\n            ></ui-input>\n            <ui-button class="small"\n                v-on:confirm="onChoosePictureEditorRootClick"\n            >\n                {{T('PREFERENCES.browse')}}\n            </ui-button>\n        </ui-prop>\n\n    </div>\n`,exports.props={profile:null,error:{towWay:!0,type:Boolean,default:!1},globalerror:{towWay:!0,type:Boolean,default:!1},show_remove:!1},exports.created=function(){this._chackPictureEditorRoot(this.picture_editor_root),this.show_remove="default"!==this.profile["script-editor"]},exports.data=function(){return{errorInfo:"",picture_editor_root:this.profile["picture-editor-root"],platform:Editor.isWin32?"win32":"other"}},exports.watch={errorInfo:{handler(t){this.globalerror=this.error=""!==t}},picture_editor_root:{handler(t){this.profile&&(this._chackPictureEditorRoot(t),this.profile["picture-editor-root"]=t)}}},exports.methods={T:Editor.T,_chackPictureEditorRoot(t){if(""!==t&&!Fs.existsSync(t))return this.errorInfo="Path [ "+t+" ] not exists!",void 0;this.errorInfo=""},onChoosePictureEditorRootClick(t){t.stopPropagation(),Utils.chooseExe("picture-editor-root",t=>{t&&(this.picture_editor_root=t[0])})},onBrowseScriptEditorClick(t){t.stopPropagation(),Utils.chooseExe("script-editor",t=>{if(!t)return;var o=Path.basenameNoExt(t[0]),e=this.profile["script-editor-list"];if(Utils.hasContains(e,t[0]))return;let i={value:t[0],text:o};e.push(i),this.profile["script-editor"]=t[0],this.profile["script-editor-list"]=e,this.show_remove=!0})},onSelectScriptEditor(t){this.show_remove="default"!==t.detail.value},onRemoveScriptEditorClick(t){t.stopPropagation();let o=this.profile["script-editor"],e=this.profile["script-editor-list"],i=Utils.getListIndexOf(e,o);-1!==i&&e.splice(i,1),e.length>0?this.profile["script-editor"]=e[0].value:(this.profile["script-editor"]="default",this.show_remove=!1)}};
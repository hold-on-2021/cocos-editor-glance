"use strict";function getImporterByName(e){for(var r=0,t=_registeredImporters.length;r<t;r++){var o=_registeredImporters[r];if(e===o.name)return o.importer}return null}function getMenuItemLabel(e,r){var t="";if(r)for(var o=0,i=r.length;o<i;o++)t&&(t+=","),t+="*."+r[o];else t=Editor.T("MAIN_MENU.file.import_select_folder");return Editor.T("MAIN_MENU.file.import_project_fmt",{name:e,exts:t})}function registerImporter(e,r,t){if(!e instanceof String||0===e.length)return Editor.error('The "name" should be a non-empty string.'),void 0;if(!t)return Editor.error("The importer should not be null."),void 0;for(var o=!1,i=0,m=_registeredImporters.length;i<m;i++){if(_registeredImporters[i].name===e){o=!0;break}}if(o)return Editor.error("Project Importer %s already existed!",e),void 0;var n=null;r&&r.length>0&&(n=r instanceof Array?r:[r]),_registeredImporters.push({name:e,exts:n,importer:t});var p=getMenuItemLabel(e,n),s=Editor.i18n.formatPath("i18n:MAIN_MENU.file.title/i18n:MAIN_MENU.file.import_project");Editor.MainMenu.add(s,[{label:p,click:function(){Editor.Ipc.sendToMain("project-importer:open",e,n)}}])}function unRegisterImporter(e){for(var r=0,t=_registeredImporters.length;r<t;r++){var o=_registeredImporters[r];if(o.name===e){var i=getMenuItemLabel(e,o.exts),m=Editor.i18n.formatPath("i18n:MAIN_MENU.file.title/i18n:MAIN_MENU.file.import_project/"+i);Editor.MainMenu.remove(m),_registeredImporters.splice(r,1);break}}}function registerDefaultImporter(){registerImporter(StudioImporter.name,StudioImporter.exts,"packages://project-importer/core/studio/studio-importer"),registerImporter(CCBImporter.name,CCBImporter.exts,"packages://project-importer/core/ccb/ccbproj-importer")}function unRegisterDefaultImporter(){unRegisterImporter(StudioImporter.name),unRegisterImporter(CCBImporter.name)}var StudioImporter=require("./studio/studio-importer"),CCBImporter=require("./ccb/ccbproj-importer"),_registeredImporters=[];module.exports={getMenuItemLabel:getMenuItemLabel,getImporterByName:getImporterByName,registerImporter:registerImporter,unRegisterImporter:unRegisterImporter,registerDefaultImporter:registerDefaultImporter,unRegisterDefaultImporter:unRegisterDefaultImporter};